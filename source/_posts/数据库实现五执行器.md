---
title: 数据库实现五执行器
date: 2024-9-14 11:19:32
tags: 数据库
categories: rust，数据库
---
## 执行器
执行器是负责执行 SQL 的组件，主要是对执行计划中的节点进行执行。然后返回正确的结果给用户。执行器在执行的过程中还会与存储引擎进行交互。这里先定义执行器，之后完善存储引擎之后，执行器才能正常工作。
## 执行器定义
这里我们将执行器定义为一个 trait ，不同的执行节点对应的不同的执行器的实现。
```rust
pub trait Executor {
    fn execute(&self) -> Result<ResultSet>;
}
```
这里的 ResultSet 是执行返回的结果。不同的 SQL 类型返回结果不相同。我们定义为枚举类型。
```rust
pub enum ResultSet {
    CreateTable {
        table_name: String,
    },
    ...
}
```
这里创建表成功后返回表名。

然后实现具体的创建表的执行器。
```rust
pub struct CreateTable {
    schema: Table,
}

impl Executor for CreateTable {
    fn execute(&self) -> Result<ResultSet> {
        todo!()
    }
}
```
这里具体的执行需要去调用存储引擎的接口，我们先留空。

这样一个简单的存储引擎就定义好了。之后等我们完成了存储引擎相关的接口，就可以从这个执行器去调用存储引擎的接口执行相应的 SQL 了。